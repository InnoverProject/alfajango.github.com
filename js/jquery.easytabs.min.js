/*
 * jQuery EasyTabs plugin 3.0
 *
 * Copyright (c) 2010-2011 Steve Schwartz (JangoSteve)
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Date: Tue Jan 19 01:30:00 2012 -0500
 */
(function(b){function a(f,c,e){var d=b.Event(c);f.trigger(d,e);return d.result!==false}b.easytabs=function(c,n){var h={animate:true,panelActiveClass:"active",tabActiveClass:"active",defaultTab:"li:first-child",animationSpeed:"normal",tabs:"> ul > li",updateHash:true,cycle:false,collapsible:false,collapsedClass:"collapsed",collapsedByDefault:true,uiTabs:false,transitionIn:"fadeIn",transitionOut:"fadeOut",transitionCollapse:"slideUp",transitionUncollapse:"slideDown",containerClass:"",tabsClass:"",tabClass:"",panelClass:"",cache:true},j=this,m=b(c),f,i,l,e,d,k={fast:200,normal:400,slow:600},g;j.init=function(){j.settings=g=b.extend({},h,n);if(g.uiTabs){g.tabActiveClass="ui-tabs-selected";g.containerClass="ui-tabs ui-widget ui-widget-content ui-corner-all";g.tabsClass="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all";g.tabClass="ui-state-default ui-corner-top";g.panelClass="ui-tabs-panel ui-widget-content ui-corner-bottom"}if(g.collapsible&&n.defaultTab!==undefined&&n.collpasedByDefault===undefined){g.collapsedByDefault=false}if(typeof(g.animationSpeed)==="string"){g.animationSpeed=k[g.animationSpeed]}b("a.anchor").remove().prependTo("body");m.data("easytabs",{});j.setTransitions();j.getTabs();j.addClasses();j.setDefaultTab();j.bindToTabClicks();j.initHashChange();j.initCycle();m.attr("data-easytabs",true)};j.setTransitions=function(){l=(g.animate)?{show:g.transitionIn,hide:g.transitionOut,speed:g.animationSpeed,collapse:g.transitionCollapse,uncollapse:g.transitionUncollapse,halfSpeed:g.animationSpeed/2}:{show:"show",hide:"hide",speed:0,collapse:"hide",uncollapse:"show",halfSpeed:0}};j.bindToTabClicks=function(){j.tabs.children("a").bind("click.easytabs",function(o){g.cycle=false;d=false;j.selectTab(b(this));o.preventDefault()})};j.getTabs=function(){var o;j.tabs=m.find(g.tabs),j.panels=b(),j.tabs.each(function(){var r=b(this),q=r.children("a"),p=r.children("a").data("target");r.data("easytabs",{});if(p!==undefined&&p!==null){r.data("easytabs").ajax=q.attr("href")}else{p=q.attr("href")}p=p.match(/#([^\?]+)/)[0].substr(1);o=m.find("#"+p);if(o.length){o.data("easytabs",{position:o.css("position"),visibility:o.css("visibility")});j.panels=j.panels.add(o.hide());r.data("easytabs").panel=o}else{j.tabs=j.tabs.not(r)}})};j.addClasses=function(){m.addClass(g.containerClass);j.tabs.parent().addClass(g.tabsClass);j.tabs.addClass(g.tabClass);j.panels.addClass(g.panelClass)};j.setDefaultTab=function(){var p=window.location.hash.match(/^[^\?]*/)[0],o=j.matchTab(p).parent(),q;if(o.length===1){f=o;g.cycle=false}else{q=j.matchInPanel(p);if(q.length){p="#"+q.attr("id");f=j.matchTab(p).parent()}else{f=j.tabs.parent().find(g.defaultTab);if(f.length===0){b.error("The specified default tab ('"+g.defaultTab+"') could not be found in the tab set.")}}}i=f.children("a").first();j.activateDefaultTab(o)};j.activateDefaultTab=function(q){var p,o;if(g.collapsible&&q.length===0&&g.collapsedByDefault){f.addClass(g.collapsedClass).children().addClass(g.collapsedClass)}else{p=b(f.data("easytabs").panel);o=f.data("easytabs").ajax;if(o&&(!g.cache||!f.data("easytabs").cached)){m.trigger("easytabs:ajax:beforeSend",[i,p]);p.load(o,function(s,r,t){f.data("easytabs").cached=true;m.trigger("easytabs:ajax:complete",[i,p,s,r,t])})}f.data("easytabs").panel.show().addClass(g.panelActiveClass);f.addClass(g.tabActiveClass).children().addClass(g.tabActiveClass)}};j.getHeightForHidden=function(p){if(p.data("easytabs")&&p.data("easytabs").lastHeight){return p.data("easytabs").lastHeight}var q=p.css("display"),o=p.wrap(b("<div>",{position:"absolute",visibility:"hidden",overflow:"hidden"})).css({position:"relative",visibility:"hidden",display:"block"}).outerHeight();p.unwrap();p.css({position:p.data("easytabs").position,visibility:p.data("easytabs").visibility,display:q});p.data("easytabs").lastHeight=o;return o};j.setAndReturnHeight=function(p){var o=p.outerHeight();if(p.data("easytabs")){p.data("easytabs").lastHeight=o}else{p.data("easytabs",{lastHeight:o})}return o};j.selectTab=function(o,t){var p=window.location,s=p.hash.match(/^[^\?]*/)[0],q=o.parent().data("easytabs").panel,r=o.parent().data("easytabs").ajax;if(g.collapsible&&!d&&(o.hasClass(g.tabActiveClass)||o.hasClass(g.collapsedClass))){j.toggleTabCollapse(o,q,r,t)}else{if(!o.hasClass(g.tabActiveClass)||!q.hasClass(g.panelActiveClass)){j.activateTab(o,q,r,t)}}};j.toggleTabCollapse=function(o,p,q,r){j.panels.stop(true,true);if(a(m,"easytabs:before",[o,p,g])){j.tabs.filter("."+g.tabActiveClass).removeClass(g.tabActiveClass).children().removeClass(g.tabActiveClass);if(o.hasClass(g.collapsedClass)){if(q&&(!g.cache||!o.parent().data("easytabs").cached)){m.trigger("easytabs:ajax:beforeSend",[o,p]);p.load(q,function(t,s,u){o.parent().data("easytabs").cached=true;m.trigger("easytabs:ajax:complete",[o,p,t,s,u])})}o.parent().removeClass(g.collapsedClass).addClass(g.tabActiveClass).children().removeClass(g.collapsedClass).addClass(g.tabActiveClass);p.addClass(g.panelActiveClass)[l.uncollapse](l.speed,function(){m.trigger("easytabs:midTransition",[o,p,g]);if(typeof r=="function"){r()}})}else{o.addClass(g.collapsedClass).parent().addClass(g.collapsedClass);p.removeClass(g.panelActiveClass)[l.collapse](l.speed,function(){m.trigger("easytabs:midTransition",[o,p,g]);if(typeof r=="function"){r()}})}}};j.activateTab=function(q,u,v,y){j.panels.stop(true,true);if(a(m,"easytabs:before",[q,u,g])){var r=j.panels.filter(":visible"),p=u.parent(),w,o,t,x,s=window.location.hash.match(/^[^\?]*/)[0];if(g.animate){w=j.getHeightForHidden(u);o=r.length?j.setAndReturnHeight(r):0;t=w-o}e=s;x=function(){m.trigger("easytabs:midTransition",[q,u,g]);if(g.animate&&g.transitionIn=="fadeIn"){if(t<0){p.animate({height:p.height()+t},l.halfSpeed).css({"min-height":""})}}if(g.updateHash&&!d){window.location.hash="#"+u.attr("id")}else{d=false}u[l.show](l.speed,function(){p.css({height:"","min-height":""});m.trigger("easytabs:after",[q,u,g]);if(typeof y=="function"){y()}})};if(v&&(!g.cache||!q.parent().data("easytabs").cached)){m.trigger("easytabs:ajax:beforeSend",[q,u]);u.load(v,function(A,z,B){q.parent().data("easytabs").cached=true;m.trigger("easytabs:ajax:complete",[q,u,A,z,B])})}if(g.animate&&g.transitionOut=="fadeOut"){if(t>0){p.animate({height:(p.height()+t)},l.halfSpeed)}else{p.css({"min-height":p.height()})}}j.tabs.filter("."+g.tabActiveClass).removeClass(g.tabActiveClass).children().removeClass(g.tabActiveClass);j.tabs.filter("."+g.collapsedClass).removeClass(g.collapsedClass).children().removeClass(g.collapsedClass);q.parent().addClass(g.tabActiveClass).children().addClass(g.tabActiveClass);j.panels.filter("."+g.panelActiveClass).removeClass(g.panelActiveClass);u.addClass(g.panelActiveClass);if(r.length){r[l.hide](l.speed,x)}else{u[l.uncollapse](l.speed,x)}}};j.matchTab=function(o){return j.tabs.find("[href='"+o+"'],[data-target='"+o+"']").first()};j.matchInPanel=function(o){return(o?j.panels.filter(":has("+o+")").first():[])};j.selectTabFromHashChange=function(){var p=window.location.hash.match(/^[^\?]*/)[0],o=j.matchTab(p),q;if(g.updateHash){if(o.length){d=true;j.selectTab(o)}else{q=j.matchInPanel(p);if(q.length){p="#"+q.attr("id");o=j.matchTab(p);d=true;j.selectTab(o)}else{if(!f.hasClass(g.tabActiveClass)&&!g.cycle){if(p===""||j.matchTab(e).length||m.closest(p).length){d=true;j.selectTab(i)}}}}}};j.cycleTabs=function(o){if(g.cycle){o=o%j.tabs.length;$tab=b(j.tabs[o]).children("a").first();d=true;j.selectTab($tab,function(){setTimeout(function(){j.cycleTabs(o+1)},g.cycle)})}};j.initHashChange=function(){if(typeof b(window).hashchange==="function"){b(window).hashchange(function(){j.selectTabFromHashChange()})}else{if(b.address&&typeof b.address.change==="function"){b.address.change(function(){j.selectTabFromHashChange()})}}};j.initCycle=function(){var o;if(g.cycle){o=j.tabs.index(f);setTimeout(function(){j.cycleTabs(o+1)},g.cycle)}};j.publicMethods={select:function(o){var p;if((p=j.tabs.filter(o)).length===0){if((p=j.tabs.find("a[href='"+o+"']")).length===0){if((p=j.tabs.find("a"+o)).length===0){if((p=j.tabs.find("[data-target='"+o+"']")).length===0){b.error("Tab '"+o+"' does not exist in tab set")}}}}else{p=p.children("a").first()}j.selectTab(p)}};j.init()};b.fn.easytabs=function(d){var c=arguments;return this.each(function(){var f=b(this),e=f.data("easytabs");if(undefined===e){e=new b.easytabs(this,d);f.data("easytabs",e)}if(e.publicMethods[d]){return e.publicMethods[d](Array.prototype.slice.call(c,1))}})}})(jQuery);
